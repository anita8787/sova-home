import{r as o,j as e,L as $}from"./index-B6ZIkdPA.js";import{N as I}from"./Navigation-DmM_F4Cd.js";function b({value:n,onChange:s,...i}){const a=o.useRef(!1);return e.jsx("input",{...i,value:n,onChange:r=>{s(r)},onCompositionStart:()=>{a.current=!0},onCompositionEnd:r=>{a.current=!1,s(r)},className:i.className||""})}const E="#6F1D1B";function A({onSubmit:n}){const[s,i]=o.useState({name:"",phone:"",email:"",delivery:"",payment:"",invoice:"",coupon:""}),[a,r]=o.useState({}),[v,D]=o.useState(!1),N=()=>{const t={};return s.name||(t.name="請輸入姓名"),s.phone||(t.phone="請輸入電話"),s.email||(t.email="請輸入 Email"),s.delivery||(t.delivery="請選擇配送方式"),s.payment||(t.payment="請選擇付款方式"),t},m=[{id:1,name:"現代舒適三人沙發",price:45800,qty:1,image:"/sofa1.png"},{id:2,name:"多功能模組沙發",price:68e3,qty:2,image:"/sofa2.png"},{id:3,name:"北歐風格單人沙發",price:28e3,qty:1,image:"/sofa3.png"},{id:4,name:"日式禪風茶几",price:12e3,qty:1,image:"/sofa4.png"}],w=m.reduce((t,p)=>t+p.price*p.qty,0),u=v?m:m.slice(0,2),F=m.length>2&&!v,g=()=>e.jsx("button",{className:"w-full py-3 rounded-lg text-white font-bold text-lg mt-6 transition",style:{background:E},onClick:()=>{const t=N();r(t),Object.keys(t).length===0&&(n?n():alert("表單驗證通過！"))},children:"提交訂單"});return e.jsxs("div",{className:"bg-white rounded-2xl shadow p-8 mb-8 animate-fadein",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"font-bold text-[#6F1D1B] text-lg mb-2",children:"購物車商品"}),e.jsx("div",{className:"space-y-2",children:u.map(t=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("img",{src:t.image,alt:t.name,className:"w-10 h-10 rounded-lg object-cover flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[t.name," ",e.jsxs("span",{className:"text-gray-400",children:["x",t.qty]})]})]}),e.jsxs("span",{className:"text-[#6F1D1B] font-bold",children:["NT$ ",(t.price*t.qty).toLocaleString()]})]},t.id))}),F&&e.jsx("button",{className:"text-xs text-[#6F1D1B] mt-2 underline",onClick:()=>D(!0),children:"查看更多 ▼"}),e.jsxs("div",{className:"flex justify-between items-center border-t pt-3 mt-3 font-bold text-base",children:[e.jsx("span",{children:"總金額"}),e.jsxs("span",{className:"text-[#6F1D1B]",children:["NT$ ",w.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex flex-col gap-6 mt-8",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-5 flex flex-col gap-3",children:[e.jsx("div",{className:"font-bold text-[#6F1D1B] mb-2",children:"訂購人資訊"}),e.jsx(b,{type:"text",value:s.name,onChange:t=>i({...s,name:t.target.value}),placeholder:"姓名*",className:"w-full px-4 py-2 rounded-lg border border-gray-200 bg-gray-50 focus:border-[#6F1D1B] focus:ring-1 focus:ring-[#6F1D1B] outline-none text-base transition"}),a.name&&e.jsx("span",{className:"text-xs text-red-500",children:a.name}),e.jsx(b,{type:"text",value:s.phone,onChange:t=>i({...s,phone:t.target.value}),placeholder:"電話*",className:"w-full px-4 py-2 rounded-lg border border-gray-200 bg-gray-50 focus:border-[#6F1D1B] focus:ring-1 focus:ring-[#6F1D1B] outline-none text-base transition"}),a.phone&&e.jsx("span",{className:"text-xs text-red-500",children:a.phone}),e.jsx(b,{type:"email",value:s.email,onChange:t=>i({...s,email:t.target.value}),placeholder:"Email*",className:"w-full px-4 py-2 rounded-lg border border-gray-200 bg-gray-50 focus:border-[#6F1D1B] focus:ring-1 focus:ring-[#6F1D1B] outline-none text-base transition"}),a.email&&e.jsx("span",{className:"text-xs text-red-500",children:a.email})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-5 flex flex-col gap-3",children:[e.jsx("div",{className:"font-bold text-[#6F1D1B] mb-2",children:"送貨與付款"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"配送方式"}),e.jsxs("select",{className:`border border-gray-200 rounded-lg px-3 py-2 focus:border-[#6F1D1B] focus:ring-1 focus:ring-[#6F1D1B] outline-none text-sm transition ${a.delivery?"border-red-400":""}`,value:s.delivery,onChange:t=>i({...s,delivery:t.target.value}),children:[e.jsx("option",{value:"",children:"請選擇"}),e.jsx("option",{children:"宅配"}),e.jsx("option",{children:"超商"}),e.jsx("option",{children:"黑貓"})]}),a.delivery&&e.jsx("span",{className:"text-xs text-red-500",children:a.delivery})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"付款方式"}),e.jsxs("select",{className:`border border-gray-200 rounded-lg px-3 py-2 focus:border-[#6F1D1B] focus:ring-1 focus:ring-[#6F1D1B] outline-none text-sm transition ${a.payment?"border-red-400":""}`,value:s.payment,onChange:t=>i({...s,payment:t.target.value}),children:[e.jsx("option",{value:"",children:"請選擇"}),e.jsx("option",{children:"信用卡"}),e.jsx("option",{children:"LINE Pay"}),e.jsx("option",{children:"貨到付款"})]}),a.payment&&e.jsx("span",{className:"text-xs text-red-500",children:a.payment})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-5 flex flex-col gap-3",children:[e.jsx("div",{className:"font-bold text-[#6F1D1B] mb-2",children:"發票與優惠碼"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"發票選項"}),e.jsxs("select",{className:"border border-gray-200 rounded-lg px-3 py-2 focus:border-[#6F1D1B] focus:ring-1 focus:ring-[#6F1D1B] outline-none text-sm transition",value:s.invoice,onChange:t=>i({...s,invoice:t.target.value}),children:[e.jsx("option",{value:"",children:"請選擇"}),e.jsx("option",{children:"自然人載具"}),e.jsx("option",{children:"統編"}),e.jsx("option",{children:"紙本發票"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"優惠碼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"text",value:s.coupon,onChange:t=>i({...s,coupon:t.target.value}),placeholder:"請輸入優惠碼",className:"w-full px-4 py-2 rounded-lg border border-gray-200 bg-gray-50 focus:border-[#6F1D1B] focus:ring-1 focus:ring-[#6F1D1B] outline-none text-base transition"}),e.jsx("button",{className:"px-3 py-2 rounded-lg text-xs font-bold text-white",style:{background:E},children:"驗證"})]})]})]})]}),g()]})}const y="#6F1D1B",f=[{id:1,name:"現代舒適三人沙發",price:45800,qty:1,image:"/sofa1.png"},{id:2,name:"多功能模組沙發",price:68e3,qty:2,image:"/sofa2.png"},{id:3,name:"簡約雙人沙發",price:52500,qty:1,image:"/sofa3.png"}],B=[{key:"cart",label:"購物車"},{key:"info",label:"填寫資料"},{key:"confirm",label:"訂單確認"}];function W(){const[n,s]=o.useState(0),[i,a]=o.useState(!1),[r,v]=o.useState({name:"",phone:"",email:"",delivery:"",payment:"",invoice:"",coupon:""}),[D,N]=o.useState({}),m=f.reduce((l,h)=>l+h.price*h.qty,0),w=()=>{const l={};return r.name||(l.name="請輸入姓名"),r.phone||(l.phone="請輸入電話"),r.email||(l.email="請輸入 Email"),r.delivery||(l.delivery="請選擇配送方式"),r.payment||(l.payment="請選擇付款方式"),l},u=()=>{if(n===0)return e.jsx("button",{className:"w-full py-3 rounded-lg text-white font-bold text-lg mt-6 transition",style:{background:y},onClick:()=>s(1),children:"前往結帳"});if(n===1)return e.jsx("button",{className:"w-full py-3 rounded-lg text-white font-bold text-lg mt-6 transition",style:{background:y},onClick:()=>{const l=w();N(l),Object.keys(l).length===0&&s(2)},children:"提交訂單"});if(n===2)return e.jsx("button",{className:"w-full py-3 rounded-lg text-white font-bold text-lg mt-6 transition",style:{background:y},onClick:()=>window.location.href="/",children:"完成"})},F=()=>{const[l,h]=o.useState({left:0,width:0,fillWidth:0}),c=o.useRef(null),k=o.useRef([]),L=n===0?0:n/(B.length-1);return o.useLayoutEffect(()=>{if(!c.current)return;const d=k.current;if(!d[0]||!d[d.length-1])return;const x=c.current.getBoundingClientRect(),j=d[0].getBoundingClientRect(),C=d[d.length-1].getBoundingClientRect(),S=j.left+j.width/2-x.left,R=C.left+C.width/2-x.left-S;h({left:S,width:R,fillWidth:R*L})},[n,B.length]),e.jsxs("div",{className:"relative flex flex-col items-center mb-10",style:{minHeight:90},ref:c,children:[e.jsxs("div",{className:"absolute top-7 z-0",style:{left:l.left,width:l.width,height:0,pointerEvents:"none"},children:[e.jsx("div",{style:{width:"100%",height:4,background:"#e5e7eb",borderRadius:2,position:"relative",zIndex:0}}),e.jsx("div",{style:{width:l.fillWidth,height:4,background:y,borderRadius:2,position:"absolute",left:0,top:0,zIndex:1,transition:"width 0.7s cubic-bezier(0.4,0,0.2,1)"}})]}),e.jsx("div",{className:"flex items-center justify-center w-full z-10",children:B.map((d,x)=>e.jsxs("div",{className:"flex flex-col items-center flex-1 relative",ref:j=>k.current[x]=j,children:[e.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center font-bold mb-2 text-2xl transition-all duration-300 ${x<n?"bg-[#6F1D1B] text-white":x===n?"bg-[#6F1D1B] text-white scale-110 shadow-lg":"bg-gray-200 text-gray-400"}`,children:x+1}),e.jsx("span",{className:`text-base mt-1 font-bold tracking-wide ${x<n||x===n?"text-[#6F1D1B]":"text-gray-400"}`,children:d.label})]},d.key))})]})},g=({simple:l=!1})=>{const h=l&&!i&&f.length>2?f.slice(0,2):f;return e.jsxs("div",{className:"space-y-4",children:[h.map(c=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:c.image,alt:c.name,className:"w-16 h-16 rounded-lg object-cover border border-gray-200"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sova-cocoa text-sm mb-1",children:c.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:["數量 x ",c.qty]})]}),e.jsxs("div",{className:"font-bold text-[#6F1D1B] text-base",children:["NT$ ",(c.price*c.qty).toLocaleString()]})]},c.id)),l&&f.length>2&&!i&&e.jsx("button",{className:"text-xs text-[#6F1D1B] mt-2 underline",onClick:()=>a(!0),children:"查看更多 ▼"})]})},t=()=>e.jsxs("div",{className:"bg-white rounded-2xl shadow p-8 mb-8 animate-fadein",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#6F1D1B]",children:"您的購物車"}),e.jsx($,{to:"/products",className:"text-xs text-[#6F1D1B] underline hover:text-[#B57E4F]",children:"繼續購物"})]}),e.jsx(g,{}),e.jsxs("div",{className:"flex justify-between items-center border-t pt-6 mt-6",children:[e.jsx("span",{className:"font-bold text-lg text-[#6F1D1B]",children:"總金額"}),e.jsxs("span",{className:"font-bold text-2xl text-[#6F1D1B]",children:["NT$ ",m.toLocaleString()]})]}),u()]}),p=()=>e.jsx(A,{onSubmit:()=>s(2)}),q=()=>e.jsxs("div",{className:"bg-white rounded-2xl shadow p-8 mb-8 animate-fadein",children:[e.jsx("div",{className:"font-bold text-[#6F1D1B] text-xl mb-6",children:"訂單確認"}),e.jsx(g,{}),e.jsxs("div",{className:"border-t pt-6 mt-6 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{children:"商品總金額"}),e.jsxs("span",{children:["NT$ ",m.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{children:"運費"}),e.jsx("span",{children:"NT$ 0"})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"應付金額"}),e.jsxs("span",{className:"text-[#6F1D1B]",children:["NT$ ",m.toLocaleString()]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"訂購人資訊"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-sm text-sova-cocoa",children:[e.jsxs("div",{children:["姓名：",r.name]}),e.jsxs("div",{children:["電話：",r.phone]}),e.jsxs("div",{children:["Email：",r.email]}),e.jsxs("div",{children:["配送方式：",r.delivery]}),e.jsxs("div",{children:["付款方式：",r.payment]}),e.jsxs("div",{children:["發票：",r.invoice]})]})]}),u()]});return e.jsxs("div",{className:"min-h-screen bg-[#FAF6F3]",children:[e.jsx(I,{}),e.jsxs("div",{className:"max-w-3xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-[#6F1D1B] mb-8 text-center tracking-wide",children:"結帳流程"}),e.jsx(F,{}),e.jsxs("div",{className:"transition-all duration-500",children:[n===0&&e.jsx(t,{}),n===1&&e.jsx(p,{}),n===2&&e.jsx(q,{})]})]})]})}export{W as default};
